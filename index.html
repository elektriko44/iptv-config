<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>IPTV REAL FIX</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.9/shaka-player.compiled.js"></script>
</head>
<body style="margin:0;background:#000;color:#fff;font-family:Arial">

<div style="display:flex;height:100vh">
  <div id="list" style="width:250px;background:#111;padding:10px"></div>
  <div id="player" style="flex:1;display:flex;align-items:center;justify-content:center"></div>
</div>

<script>
shaka.polyfill.installAll();

const IPTV_TOKENS = {
  converge: "PASTE_REAL_TOKEN"
};

function withToken(u,k){
  return u + "?token=" + IPTV_TOKENS[k];
}
function hexToB64(hex){
  const b=new Uint8Array(hex.match(/.{1,2}/g).map(x=>parseInt(x,16)));
  return btoa(String.fromCharCode(...b));
}

const channels=[
{
  name:"RPTV",
  url:withToken("https://converse.nathcreqtives.com/1094/manifest.mpd","converge"),
  drm:true,
  keyId:"31363231383439313133323034313530",
  key:"78645370476a496d5756385231474332"
},
{
  name:"A2Z",
  url:"https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_a2z/default/index.mpd",
  drm:true,
  keyId:"f703e4c8ec9041eeb5028ab4248fa094",
  key:"c22f2162e176eee6273a5d0b68d19530"
}
];

const list=document.getElementById('list');
channels.forEach(c=>{
  const d=document.createElement('div');
  d.innerText=c.name;
  d.style.padding="10px";
  d.style.cursor="pointer";
  d.onclick=()=>play(c);
  list.appendChild(d);
});

async function play(c){
  const box=document.getElementById('player');
  box.innerHTML="";

  const video=document.createElement('video');
  video.controls=true;
  video.autoplay=true;
  box.appendChild(video);

  // ðŸ”¥ CRITICAL PART
  const player = new shaka.Player();
  await player.attach(video);

  if(c.drm){
    player.configure({
      drm:{clearKeys:{[hexToB64(c.keyId)]:hexToB64(c.key)}}
    });
  }

  await player.load(c.url);
}
</script>

</body>
</html>
